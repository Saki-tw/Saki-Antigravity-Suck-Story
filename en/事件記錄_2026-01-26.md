# Field Log: 2026-01-26 - Antigravity Incident

> **Timestamp**: 2026-01-26 12:31
> **Observer**: The Architect

---

## The Mystery of the Language Server (12:26)

### Observation
- Execution of `pkill -f antigravity` terminated the Language Server.
- However, the main Antigravity.app process survived.

### Investigation
```
lsof -i :3000 output:
- antigravi 62855 (Our Rust Service) → LISTEN
- Antigravi 63078 (Antigravity.app) → ESTABLISHED Connection
```

### Conclusion
- Antigravity.app (63078) is the **Client**, not the Server.
- This is actually the VSX plugin fetching data from our API.
- The Language Server appears to be an independent process communicating via port 3000.
- `pkill -f antigravity` was too indiscriminate. It caused collateral damage.

---

## Resolving Exit 130 (Approx. 10:00-11:00)

### Anomaly
- Rust service panic on startup: "error binding to 0.0.0.0:3000: Address already in use (os error 48)"

### Root Cause
- Multiple `antigravity-rs` processes competing for port 3000.
- The old king refused to abdicate before the new one ascended.

### Resolution
1. Surgically terminate the process occupying the port:
   ```bash
   lsof -i :3000 | awk 'NR>1 {print $2}' | xargs kill -9
   ```
2. Wait for port release.
3. Avoid `pkill -f antigravity` (too broad).

---

## The Mock Data Deception (12:20)

### Anomaly
- Quota API returned false data ("remaining": 100, "Tomorrow 00:00").
- Users detected the deception.

### Root Cause
- A lazy `TODO` note found in `api/mod.rs` at line 299.
- The code was returning hardcoded simulation data.

### Fix (Failed Attempt)
1. Injected `QUOTA_SCRAPE_SCRIPT` into `injection.rs`.
2. Attempted to extract quota from the Antigravity UI DOM (**This method was later proven ineffective**).
3. Corrected type mismatch (i32 → u32).

---

## Compilation Phantom (12:29)

### Anomaly
- `cargo build` reported success, but the binary timestamp remained unchanged (11:57).

### Root Cause
- Cargo cache believed no changes had occurred.

### Resolution
- Forced re-compilation by touching the source file:
  ```bash
  touch src/api/mod.rs
  cargo build --release
  ```

---

## Extension v0.6.0 Deployment (12:59)

### New Features
1. **Auto Accept Status Indicator**
   - Status bar displays `$(check) Auto` or `$(error) Auto OFF`.
   - Red background when Auto is OFF.

2. **Quota API Timeout (3s)**
   - Prevents system freeze if CDP fails to respond.
   - Returns `CDP_TIMEOUT_OR_ERROR`.

3. **Extension Fetch Timeout (5s)**
   - Displays detailed error messages.
   - Status indicators: `$(warning) Quota?` or `$(error) API`.

### Retry Button Malfunction
- Multiple reports of the Retry button failing to auto-click.
- The auto-click loop requires further investigation.

---

## Quota API Research Failures (14:00-15:00)

### Errors
1. **False Assumption**: Believed quota could be scraped from the DOM.
2. **Implementation Error**: Used `chromiumoxide Browser::connect` (requires browser-level WS).
3. **Diagnostic Error**: Mistakenly judged `tokio-tungstenite` as inferior to `chromiumoxide`.
4. **Contaminated Sample**: Referenced a Simplified Chinese project containing account polling logic.

### Correct Findings
- Quota must be obtained from the **Language Server API**, not the UI DOM.
- API Endpoint: `/exa.language_server_pb.LanguageServerService/GetUserStatus`
- Must extract `connect_port` and `csrf_token` from process arguments.
- CDP Port 9000 returns `ws://` (No TLS required).

### Risk Assessment: Simplified Chinese Projects
| Keyword Combination | Risk Level |
|-----------|----------|
| Account Polling + Reverse Proxy | ❌ 100% Ban (Immediate Termination) |
| GetUserStatus (Read-Only) | ✅ Safe |

### Lesson Learned
- READMEs only tell you the author's delusions.
- The truth is always in the code.
- Avoid implementations containing "Account Polling" at all costs.


---

> *They love to hear ghosts chant poetry by autumn graves.*
